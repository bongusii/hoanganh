<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://github.com/bongusii/hoanganh/blob/main/icon.png?raw=true">
    <title>Phan Hoang Anh's Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Quicksand', sans-serif; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 10px; }
        .portfolio-item { transition: transform 0.3s ease, opacity 0.3s ease; cursor: pointer; }
        .portfolio-item.hidden-item { transform: scale(0.9); opacity: 0; display: none; }
        #video-modal-overlay, #pdf-modal-overlay, #project-detail-modal-overlay, #rating-modal-overlay { transition: opacity 0.3s ease-in-out; }
        #video-modal-content, #pdf-modal-content, #project-detail-modal-content, #rating-modal-content { transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out; }
        .progress-ring__circle {
            transition: stroke-dashoffset 0.8s ease-out;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        #visitor-counter {
            transform: translateY(100px);
            transition: transform 0.8s ease-in-out, opacity 0.5s ease-in-out;
            opacity: 0;
        }
        #visitor-counter.show {
            transform: translateY(0);
            opacity: 1;
        }
        .rating-stars label {
            color: #4b5563;
            cursor: pointer;
            transition: color 0.2s;
        }
        .rating-stars input:checked ~ label,
        .rating-stars:not(:checked) > label:hover,
        .rating-stars:not(:checked) > label:hover ~ label {
            color: #f59e0b;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 antialiased">

    <nav id="navbar" class="fixed w-full top-0 z-50 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <a href="#" class="text-2xl font-bold text-white tracking-wider">Phan Hoàng Anh</a>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#hero" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Trang chủ</a>
                        <a href="#about" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Giới thiệu</a>
                        <a href="#work" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Dự án</a>
                        <a href="#skills" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Kỹ năng</a>
                        <a href="#rating" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Đánh giá</a>
                        <a href="#contact" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Liên hệ</a>
                    </div>
                </div>
                <div class="-mr-2 flex md:hidden">
                    <button id="mobile-menu-button" type="button" class="bg-gray-800 inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white">
                        <span class="sr-only">Mở menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="md:hidden hidden"><div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
            <a href="#hero" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Trang chủ</a>
            <a href="#about" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Giới thiệu</a>
            <a href="#work" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Dự án</a>
            <a href="#skills" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Kỹ năng</a>
            <a href="#rating" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Đánh giá</a>
            <a href="#contact" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Liên hệ</a>
        </div></div>
    </nav>
    
    <header id="hero" class="min-h-screen flex items-center bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl md:text-6xl font-extrabold text-white leading-tight mb-4">Chào bạn, tôi là <span class="text-teal-400">Hoàng Anh</span></h1>
            <p class="text-lg md:text-2xl text-gray-300 max-w-3xl mx-auto">UI Developer, Graphics Designer, Photo & Videographer.<br>Tôi kiến tạo những trải nghiệm số và ghi lại những khoảnh khắc đẹp.</p>
            <div class="mt-8"><a href="#work" class="nav-link bg-teal-500 text-white font-bold py-3 px-8 rounded-full hover:bg-teal-600 transition duration-300 text-lg">Xem dự án của tôi</a></div>
        </div>
    </header>

    <main class="bg-gray-900">
        <section id="about" class="py-20 sm:py-32">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="lg:grid lg:grid-cols-3 lg:gap-8 items-center">
                    <div class="lg:col-span-1"><img class="rounded-lg shadow-2xl object-cover h-96 w-full lg:h-auto" src="https://github.com/bongusii/hoanganh/blob/main/BONGUSI.jpg?raw=true" alt="Ảnh chân dung của bạn" loading="lazy"></div>
                    <div class="mt-12 lg:mt-0 lg:col-span-2">
                        <h2 class="text-3xl font-bold text-white sm:text-4xl mb-6">Về tôi</h2>
                        <p class="text-lg text-gray-300 mb-4">Xin chào! Tôi là một người đam mê sáng tạo với nền tảng vững chắc về công nghệ và nghệ thuật. Với kinh nghiệm trong lĩnh vực lập trình giao diện người dùng (UI), tôi tập trung vào việc xây dựng các trang web và ứng dụng không chỉ mạnh mẽ về mặt chức năng mà còn tinh tế về mặt thẩm mỹ.</p>
                        <p class="text-lg text-gray-300 mb-4">Bên cạnh đó, nhiếp ảnh và quay phim là nơi tôi kể những câu chuyện bằng hình ảnh. Tôi yêu thích việc bắt trọn những cảm xúc chân thật và biến những ý tưởng thành những thước phim sống động. Sự kết hợp giữa tư duy logic của lập trình viên và con mắt nghệ thuật của người làm hình ảnh cho phép tôi tạo ra những sản phẩm độc đáo và toàn diện.</p>
                        <div class="mt-6"><a href="https://drive.google.com/uc?export=download&id=1AWEP93eF7O5FUH1sO8HbQ3JtLBLKDKwR" class="text-teal-400 font-semibold hover:text-teal-300">Tải CV của tôi <span aria-hidden="true">&rarr;</span></a></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="work" class="py-20 sm:py-32 bg-gray-800/30">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center"><h2 class="text-3xl font-bold text-white sm:text-4xl">Dự án nổi bật</h2><p class="mt-4 text-lg text-gray-400">Một vài sản phẩm tôi đã thực hiện.</p></div>
                <div id="filter-buttons" class="flex justify-center space-x-2 md:space-x-4 my-10 flex-wrap">
                    <button class="filter-btn active bg-teal-500 text-white px-4 py-2 rounded-full text-sm font-medium" data-filter="all">Tất cả</button>
                    <button class="filter-btn bg-gray-700 text-gray-300 hover:bg-gray-600 px-4 py-2 rounded-full text-sm font-medium" data-filter="ui">Lập trình UI</button>
                    <button class="filter-btn bg-gray-700 text-gray-300 hover:bg-gray-600 px-4 py-2 rounded-full text-sm font-medium" data-filter="design">Thiết kế</button>
                    <button class="filter-btn bg-gray-700 text-gray-300 hover:bg-gray-600 px-4 py-2 rounded-full text-sm font-medium" data-filter="photo">Nhiếp ảnh</button>
                    <button class="filter-btn bg-gray-700 text-gray-300 hover:bg-gray-600 px-4 py-2 rounded-full text-sm font-medium" data-filter="video">Video</button>
                </div>
                <div id="portfolio-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div id="loading-spinner" class="col-span-full flex justify-center items-center p-16">
                        <svg class="animate-spin -ml-1 mr-3 h-10 w-10 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                        <span class="text-xl">Đang tải dự án...</span>
                    </div>
                </div>
            </div>
        </section>

        <section id="skills" class="py-20 sm:py-32">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-white sm:text-4xl">Công cụ & Kỹ năng</h2>
                    <p class="mt-4 text-lg text-gray-400">Nhấp vào từng kỹ năng để xem chứng chỉ liên quan.</p>
                </div>
                <div class="mt-20 max-w-5xl mx-auto grid grid-cols-2 sm:grid-cols-4 gap-y-12 gap-x-8">
                    </div>
            </div>
        </section>

        <section id="rating" class="py-20 sm:py-32 bg-gray-800/30">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-white sm:text-4xl">Đánh giá & Phản hồi</h2>
                    <p class="mt-4 text-lg text-gray-400">Sự hài lòng của bạn là động lực của tôi.</p>
                    
                    <div class="mt-12 flex flex-col items-center">
                        <div id="rating-display" class="flex items-center space-x-1 text-gray-500 text-3xl">
                            </div>
                        <p class="mt-4 text-gray-300">
                            <span id="average-rating" class="font-bold text-xl text-white">...</span> trên 5 sao
                            <span class="text-gray-500 mx-2">|</span>
                            <span id="total-ratings" class="font-bold">...</span> lượt đánh giá
                        </p>
                    </div>

                    <div class="mt-10">
                        <button id="open-rating-modal-btn" class="bg-teal-500 text-white font-bold py-3 px-8 rounded-full hover:bg-teal-600 transition duration-300 text-lg">Để lại đánh giá</button>
                        <p id="rating-thank-you" class="hidden mt-4 text-teal-400">Cảm ơn bạn! Bình luận của bạn đang chờ được duyệt.</p>
                    </div>
                </div>

                <div class="mt-20 max-w-3xl mx-auto">
                    <h3 class="text-2xl font-bold text-white text-center mb-8">Mọi người nói gì...</h3>
                    <div id="comment-list" class="space-y-6">
                        </div>
                    <div class="text-center mt-8">
                        <button id="load-more-comments-btn" class="hidden bg-gray-700 text-gray-300 hover:bg-gray-600 px-6 py-2 rounded-full font-medium">Xem thêm</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="py-24 sm:py-40">
            <div class="max-w-3xl mx-auto text-center px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl font-bold text-white sm:text-4xl">Cùng hợp tác nhé!</h2>
                <p class="mt-4 text-lg text-gray-400">Tôi luôn sẵn sàng lắng nghe những ý tưởng mới và tham gia vào các dự án thú vị. Hãy liên hệ với tôi qua email hoặc các mạng xã hội bên dưới.</p>
                <p class="mt-4 text-lg text-gray-400">Hoặc qua số điện thoại: 0982.062.971</p>
                <div class="mt-8"><a href="mailto:bongusi9124@gmail.com" class="bg-teal-500 text-white font-bold py-3 px-8 rounded-full hover:bg-teal-600 transition duration-300 text-lg">Gửi Email</a></div>
                <div class="mt-10 flex justify-center space-x-6">
                    <a href="https://github.com/bongusii" class="text-gray-400 hover:text-white" aria-label="My GitHub Profile"><span class="sr-only">GitHub</span><i data-lucide="github" class="w-6 h-6"></i></a>
                    <a href="https://www.instagram.com/bongusi.9124" class="text-gray-400 hover:text-white" aria-label="My Instagram Profile"><span class="sr-only">Instagram</span><i data-lucide="instagram" class="w-6 h-6"></i></a>
                    <a href="https://www.youtube.com/@bongusiii" class="text-gray-400 hover:text-white" aria-label="My YouTube Channel"><span class="sr-only">YouTube</span><i data-lucide="youtube" class="w-6 h-6"></i></a>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800/30">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-gray-500">
            <p>&copy; 2025 Phan Hoang Anh. Đã đăng ký bản quyền.</p>
        </div>
    </footer>

    <div id="rating-modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-[52] p-4">
        <div id="rating-modal-content" class="bg-gray-800 w-full max-w-md rounded-lg shadow-2xl relative transform scale-95 opacity-0">
            <button id="close-rating-modal-btn" class="absolute top-3 right-3 text-gray-400 hover:text-white">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <div class="p-8">
                <h3 class="text-2xl font-semibold text-white mb-2 text-center">Để lại đánh giá của bạn</h3>
                <p class="text-gray-400 mb-6 text-center">Hãy chọn số sao và chia sẻ cảm nhận nhé.</p>
                
                <form id="rating-form">
                    <div class="flex items-center justify-center flex-row-reverse text-5xl rating-stars mb-6">
                        <input type="radio" id="star5" name="rating" value="5" class="sr-only" required /><label for="star5" title="5 sao">&#9733;</label>
                        <input type="radio" id="star4" name="rating" value="4" class="sr-only" /><label for="star4" title="4 sao">&#9733;</label>
                        <input type="radio" id="star3" name="rating" value="3" class="sr-only" /><label for="star3" title="3 sao">&#9733;</label>
                        <input type="radio" id="star2" name="rating" value="2" class="sr-only" /><label for="star2" title="2 sao">&#9733;</label>
                        <input type="radio" id="star1" name="rating" value="1" class="sr-only" /><label for="star1" title="1 sao">&#9733;</label>
                    </div>
                    <div class="space-y-4">
                        <div>
                            <label for="comment-name" class="block text-gray-300 text-sm font-bold mb-2">Tên của bạn</label>
                            <input type="text" id="comment-name" name="name" placeholder="Tên hiển thị (hoặc để trống)" class="w-full bg-gray-700 border border-gray-600 rounded-lg py-2 px-3 text-white focus:outline-none focus:border-teal-500">
                        </div>
                        <div>
                            <label for="comment-text" class="block text-gray-300 text-sm font-bold mb-2">Bình luận</label>
                            <textarea id="comment-text" name="comment" rows="4" placeholder="Chia sẻ cảm nhận của bạn ở đây..." class="w-full bg-gray-700 border border-gray-600 rounded-lg py-2 px-3 text-white focus:outline-none focus:border-teal-500" required></textarea>
                        </div>
                    </div>
                    <button type="submit" class="w-full mt-8 bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-4 rounded-lg transition duration-300">Gửi đi</button>
                </form>
            </div>
        </div>
    </div>

    <div id="visitor-counter" class="fixed bottom-5 left-5 bg-gray-800/80 backdrop-blur-sm text-white py-2 px-4 rounded-lg shadow-lg flex items-center space-x-2 z-40">
        <i data-lucide="users" class="w-5 h-5"></i>
        <p class="text-sm">Lượt truy cập: <span id="visit-count" class="font-bold">...</span></p>
    </div>

    <script type="module">
        import { db, projectsCollectionRef } from './firebase-config.js';
        import { onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { 
            doc, getDoc, updateDoc, increment, runTransaction,
            collection, query, where, orderBy, limit, Timestamp, startAfter, addDoc 
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- GLOBAL ELEMENTS & VARIABLES ---
        const ratingDisplay = document.getElementById('rating-display');
        const averageRatingSpan = document.getElementById('average-rating');
        const totalRatingsSpan = document.getElementById('total-ratings');
        const openRatingModalBtn = document.getElementById('open-rating-modal-btn');
        const closeRatingModalBtn = document.getElementById('close-rating-modal-btn');
        const ratingModalOverlay = document.getElementById('rating-modal-overlay');
        const ratingModalContent = document.getElementById('rating-modal-content');
        const ratingForm = document.getElementById('rating-form');
        const ratingThankYou = document.getElementById('rating-thank-you');
        const commentList = document.getElementById('comment-list');
        const loadMoreBtn = document.getElementById('load-more-comments-btn');
        let lastVisibleComment = null;

        // --- RATING & COMMENT LOGIC ---
        async function displayRatingSummary() {
            const ratingRef = doc(db, "counters", "rating_summary");
            try {
                const docSnap = await getDoc(ratingRef);
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    const totalRatings = data.total_ratings || 0;
                    const totalScore = data.total_score || 0;
                    const average = totalRatings > 0 ? (totalScore / totalRatings) : 0;
                    
                    averageRatingSpan.textContent = average.toFixed(1);
                    totalRatingsSpan.textContent = totalRatings.toLocaleString('vi-VN');
                    
                    ratingDisplay.innerHTML = '';
                    for (let i = 1; i <= 5; i++) {
                        const star = document.createElement('span');
                        star.innerHTML = i <= Math.round(average) ? '&#9733;' : '&#9734;';
                        if (i <= Math.round(average)) star.classList.add('text-amber-400');
                        ratingDisplay.appendChild(star);
                    }
                }
            } catch (error) { console.error("Error fetching rating summary:", error); }
        }

        ratingForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(ratingForm);
            const selectedRating = formData.get('rating');
            const commentText = formData.get('comment').trim();
            let commenterName = formData.get('name').trim() || 'Ẩn danh';

            if (!selectedRating) { alert('Vui lòng chọn số sao!'); return; }

            const newScore = parseInt(selectedRating, 10);
            
            try {
                await addDoc(collection(db, "comments"), {
                    name: commenterName,
                    comment: commentText,
                    rating: newScore,
                    timestamp: Timestamp.fromDate(new Date()),
                    approved: false
                });

                const ratingRef = doc(db, "counters", "rating_summary");
                await runTransaction(db, async (transaction) => {
                    const ratingDoc = await transaction.get(ratingRef);
                    const newTotalScore = (ratingDoc.data().total_score || 0) + newScore;
                    const newTotalRatings = (ratingDoc.data().total_ratings || 0) + 1;
                    transaction.update(ratingRef, { total_score: newTotalScore, total_ratings: newTotalRatings });
                });
                
                localStorage.setItem('hasVotedPortfolio', 'true');
                closeRatingModal();
                checkIfVoted();
                await displayRatingSummary();

            } catch (error) {
                console.error("Submission failed: ", error);
                alert("Đã có lỗi xảy ra. Vui lòng thử lại.");
            }
        });

        function openRatingModal() {
            ratingModalOverlay.classList.remove('hidden');
            setTimeout(() => ratingModalContent.classList.remove('scale-95', 'opacity-0'), 10);
        }
        function closeRatingModal() {
            ratingModalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => ratingModalOverlay.classList.add('hidden'), 300);
        }
        
        function checkIfVoted() {
            if (localStorage.getItem('hasVotedPortfolio')) {
                openRatingModalBtn.classList.add('hidden');
                ratingThankYou.classList.remove('hidden');
            }
        }

        async function fetchComments(loadMore = false) {
            const commentsPerPage = 3;
            let q;
            const commentsRef = collection(db, "comments");

            if (loadMore && lastVisibleComment) {
                q = query(commentsRef, where("approved", "==", true), orderBy("timestamp", "desc"), startAfter(lastVisibleComment), limit(commentsPerPage));
            } else {
                commentList.innerHTML = '<p class="text-gray-400 text-center">Đang tải bình luận...</p>';
                q = query(commentsRef, where("approved", "==", true), orderBy("timestamp", "desc"), limit(commentsPerPage));
            }

            const querySnapshot = await getDocs(q);
            const docs = querySnapshot.docs;

            if (!loadMore) {
                commentList.innerHTML = '';
                if (docs.length === 0) commentList.innerHTML = '<p class="text-gray-400 text-center">Chưa có bình luận nào.</p>';
            }

            docs.forEach(doc => {
                const comment = doc.data();
                const item = document.createElement('div');
                item.className = 'bg-gray-700/50 p-5 rounded-lg';
                item.innerHTML = `
                    <div class="flex items-center mb-2">
                        <h4 class="font-bold text-white mr-3">${comment.name}</h4>
                        <div class="flex text-amber-400">
                            ${'&#9733;'.repeat(comment.rating)}${'&#9734;'.repeat(5 - comment.rating)}
                        </div>
                    </div>
                    <p class="text-gray-300 italic">"${comment.comment}"</p>
                `;
                commentList.appendChild(item);
            });
            
            lastVisibleComment = docs[docs.length - 1];
            loadMoreBtn.classList.toggle('hidden', docs.length < commentsPerPage);
        }

        openRatingModalBtn.addEventListener('click', openRatingModal);
        closeRatingModalBtn.addEventListener('click', closeRatingModal);
        ratingModalOverlay.addEventListener('click', (e) => e.target === ratingModalOverlay && closeRatingModal());
        loadMoreBtn.addEventListener('click', () => fetchComments(true));

        // --- VISITOR COUNTER LOGIC ---
        async function updateVisitorCount() {
            const counterRef = doc(db, "counters", "visits");
            try {
                if (!sessionStorage.getItem('hasVisitedPortfolio')) {
                    await updateDoc(counterRef, { count: increment(1) });
                    sessionStorage.setItem('hasVisitedPortfolio', 'true');
                }
                const docSnap = await getDoc(counterRef);
                const count = docSnap.exists() ? docSnap.data().count : 'N/A';
                document.getElementById('visit-count').textContent = count.toLocaleString('vi-VN');
                setTimeout(() => document.getElementById('visitor-counter').classList.add('show'), 500);
            } catch (error) { console.error("Error updating visitor count:", error); }
        }

        // --- OTHER PAGE LOGIC (Projects, Modals, Nav, etc.) ---
        // (This section should contain the rest of your JS logic for the page)

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            updateVisitorCount();
            displayRatingSummary();
            checkIfVoted();
            fetchComments();
            lucide.createIcons();
            // Add other initial function calls here (e.g., for projects)
        });
    </script>
</body>
</html>